<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Utilities for handling the `wp_presentation` protocol"><meta name="keywords" content="rust, rustlang, rust-lang, presentation"><title>smithay::wayland::presentation - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-a6e10e60fb712b0f.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../../static.files/light-5f7299aa2b503fb1.css"><link rel="stylesheet" disabled href="../../../static.files/dark-dfb18ef8114bb428.css"><link rel="stylesheet" disabled href="../../../static.files/ayu-4047a6aaddd3789d.css"><script id="default-settings" ></script><script src="../../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../smithay/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../smithay/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module presentation</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">smithay</a>::<wbr><a href="../index.html">wayland</a>::<wbr><a class="mod" href="#">presentation</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/smithay/wayland/presentation/mod.rs.html#1-317">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Utilities for handling the <code>wp_presentation</code> protocol</p>
<h3 id="how-to-use-it"><a href="#how-to-use-it">How to use it</a></h3><h4 id="initialization"><a href="#initialization">Initialization</a></h4>
<p>To initialize this implementation, create <a href="struct.PresentationState.html" title="PresentationState"><code>PresentationState</code></a>, store it in your <code>State</code> struct and
implement the required traits, as shown in this example:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>smithay::wayland::presentation::PresentationState;
<span class="kw">use </span>smithay::delegate_presentation;

<span class="comment">// Create the viewporter state:
</span><span class="kw">let </span>viewporter_state = PresentationState::new::&lt;State&gt;(
    <span class="kw-2">&amp;</span>display.handle(), <span class="comment">// the display
    </span><span class="number">1 </span><span class="comment">// the id of the clock
</span>);

<span class="comment">// implement Dispatch for the Viewporter types
</span><span class="macro">delegate_presentation!</span>(State);

<span class="comment">// You&#39;re now ready to go!</span></code></pre></div>
<h4 id="use-the-presentation-state"><a href="#use-the-presentation-state">Use the presentation state</a></h4>
<p>Before sending the frame callbacks you should drain all committed presentation feedback callbacks.
After the associated frame has been presented the callbacks can be marked presented as shown in
the example.</p>
<p>The <a href="struct.PresentationFeedbackCachedState.html"><code>presentation state</code></a> is double-buffered and
can be accessed by using the <a href="../compositor/fn.with_states.html" title="with_states"><code>with_states</code></a> function</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>smithay::wayland::presentation::PresentationFeedbackCachedState;
<span class="kw">use </span>wayland_protocols::wp::presentation_time::server::wp_presentation_feedback;

<span class="comment">// ... render frame ...

</span><span class="kw">let </span>presentation_feedbacks = with_states(<span class="kw-2">&amp;</span>surface, |states| {
    std::mem::take(<span class="kw-2">&amp;mut </span>states.cached_state.current::&lt;PresentationFeedbackCachedState&gt;().callbacks)
});

<span class="comment">// ... send frame callbacks and present frame

</span><span class="kw">for </span>feedback <span class="kw">in </span>presentation_feedbacks {
    feedback.presented(<span class="kw-2">&amp;</span>output, time, refresh, seq, wp_presentation_feedback::Kind::Vsync);
}</code></pre></div>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PresentationFeedbackCachedState.html" title="smithay::wayland::presentation::PresentationFeedbackCachedState struct">PresentationFeedbackCachedState</a></div><div class="item-right docblock-short">State of a single presentation feedback requested
for a surface</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PresentationFeedbackCallback.html" title="smithay::wayland::presentation::PresentationFeedbackCallback struct">PresentationFeedbackCallback</a></div><div class="item-right docblock-short">Holds a single presentation feedback</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PresentationFeedbackState.html" title="smithay::wayland::presentation::PresentationFeedbackState struct">PresentationFeedbackState</a></div><div class="item-right docblock-short">State for a single presentation feedback callback</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PresentationState.html" title="smithay::wayland::presentation::PresentationState struct">PresentationState</a></div><div class="item-right docblock-short">State of the wp_presentation global</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="smithay" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0-nightly (5e37043d6 2023-01-22)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>